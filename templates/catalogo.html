{% extends "base.html" %}
{% block title %}Cat치logo{% endblock %}
{% block content %}

<div class="container my-5">
  <h2 class="text-center mb-4">Cat치logo de Productos</h2>
  <div class="row g-4">
    {% for p in products %}
    <div class="col-md-3">
      <div class="card h-100 shadow-sm product-card">

        <!-- Imagen clickeable para agrandar -->
        <img src="{% if p.foto_producto %}
                    {{ url_for('static', filename='img/' ~ p.foto_producto) }}
                  {% else %}
                    {{ url_for('static', filename='no-image.png') }}
                  {% endif %}"
             class="card-img-top img-click"
             alt="{{ p.nombre }}"
             style="height:250px;object-fit:cover; cursor:pointer;"
             data-img="{% if p.foto_producto %}
                         {{ url_for('static', filename='img/' ~ p.foto_producto) }}
                       {% else %}
                         {{ url_for('static', filename='no-image.png') }}
                       {% endif %}">

        <div class="card-body d-flex flex-column">
          <h5 class="card-title text-center">{{ p.nombre }}</h5>
          <p class="card-text text-muted small">{{ p.descripcion }}</p>
          <p class="price text-center fw-bold">
            ${{ "%.2f"|format(p.precio_producto) }}
          </p>

          <!-- Formulario para a침adir al carrito -->
          <form action="{{ url_for('carrito.add_to_cart', product_id=p.id_producto) }}" method="POST">
            <div class="d-flex justify-content-center mb-2">
              <select name="talla" class="form-select form-select-sm" required>
                <option value="">Talla</option>
                <option value="S">S</option>
                <option value="M">M</option>
                <option value="L">L</option>
                <option value="XL">XL</option>
              </select>
            </div>
            <button type="submit" class="btn btn-dark w-100">A침adir al carrito</button>
          </form>
        </div>
      </div>
    </div>
    {% endfor %}
  </div>
</div>

<!-- Modal para ampliar la imagen -->
<div class="modal fade" id="imgModal" tabindex="-1">
  <div class="modal-dialog modal-dialog-centered modal-lg">
    <div class="modal-content bg-dark">
      <div class="modal-body p-0 text-center">
        <img id="modalImg" src="" class="img-fluid rounded">
      </div>
    </div>
  </div>
</div>

<!-- Script para activar el modal -->
<script>
document.addEventListener("DOMContentLoaded", function () {
  document.querySelectorAll(".img-click").forEach(img => {
    img.addEventListener("click", function () {
      const url = this.getAttribute("data-img");
      document.getElementById("modalImg").src = url;
      const modal = new bootstrap.Modal(document.getElementById('imgModal'));
      modal.show();
    });
  });
});
</script>

{% endblock %}
